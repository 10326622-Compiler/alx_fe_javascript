// Function to sync with server
async function syncQuotes() {
  showNotification('Syncing with server...', 2000);
  
  // Fetch quotes from server
  const serverQuotes = await fetchQuotesFromServer();
  
  if (!serverQuotes) {
    showNotification('Sync failed - could not reach server', 3000);
    return;
  }
  
  // Check for conflicts
  const conflicts = resolveConflicts(quotes, serverQuotes);
  
  if (conflicts.length > 0) {
    showNotification(
      `Conflicts detected and resolved (${conflicts.length} conflicts). Server data took precedence.`,
      5000
    );
    
    console.log('Conflicts resolved:', conflicts);
  }
  
  // Merge quotes (server takes precedence)
  const mergedQuotes = mergeQuotes(quotes, serverQuotes);
  
  const oldCount = quotes.length;
  quotes = mergedQuotes;
  const newCount = quotes.length;
  
  // Save to local storage
  saveQuotes();
  
  // Update categories
  populateCategories();
  
  // Post current quotes to server
  await postQuotesToServer(quotes);
  
  // Update sync status
  const now = new Date().toLocaleTimeString();
  syncStatus.textContent = `Last sync: ${now}`;
  localStorage.setItem('lastSyncTime', now);
  
  // Show notification
  showNotification('Quotes synced with server!', 3000);
  
  const addedCount = newCount - oldCount;
  if (addedCount > 0) {
    console.log(`${addedCount} new quotes added from server.`);
  }
  if (conflicts.length > 0) {
    console.log(`${conflicts.length} conflicts resolved.`);
  }
  
  // Refresh display
  showRandomQuote();
}
